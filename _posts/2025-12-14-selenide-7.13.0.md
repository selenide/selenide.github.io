---
layout: post
title: "Released Selenide 7.13.0"
description: ""
category:
header-text: "Downloading clouds"
tags: []
---
{% include JB/setup %}

Hello, coldies!

We've got a new release [Selenide 7.13.0](https://github.com/selenide/selenide/milestone/235?closed=1), let's start the unboxing!

<br>

* [Sped up downloading files from Selenium Grid](#improve-file-downloading-from-grid)
* [Download doesn't wait too long if the link is not found](#fail-fast-if-download-link-not-found)
* [Mask credentials in remote URL](#mask-credentials-in-remote-url)
* [Added method `proxy.cleanupFilters()`](#proxy-cleanup-filters)
* [Removed warning about response size](#remove-response-size-watchdog)
* [Added prefix to all Selenide proxy filters](#add-prefix-to-selenide-own-filters)
* [Fixed video rate](#fix-frame-rate-for-video)
* [Upgraded Selenium from 4.38.0 to 4.39.0](#update-to-selenium-4.39.0)

<br>

### Sped up downloading files from Selenium Grid {#improve-file-downloading-from-grid}

Selenide has method `$.download()` that downloads a file in the browser, and returns this file.
It's useful for testing all kinds of reports, Excel and PDF files etc.

> This is a highly non-trivial operation in itself.
> Selenide implements several algorithms under the hood ([HTTPGET, PROXY, FOLDER, CDP](/2019/12/10/advent-calendar-download-files/)), each with its own pros and cons.
> Not all of them, for example, work with a remote browser.

So, the FOLDER method hasn't worked well with Selenium Grid up until now, especially when the file being downloaded is large (say, over 100 MB).
There was also no reliable way to wait for the download to complete.

Things got much better now:
1. We can track download completion by file modification date (thanks to [PR 16589](https://github.com/SeleniumHQ/selenium/pull/16589)), and
2. Downloading large files has been dramatically sped up (thanks to [PR 16627](https://github.com/SeleniumHQ/selenium/pull/16627)).

I tried downloading files up to 4 gigabytes from the grid – it flew off the server like a cannonball. :)

See [PR 3207](https://github.com/selenide/selenide/pull/3207).

<br>

### Download doesn't wait too long if the link is not found {#fail-fast-if-download-link-not-found}
Another improvement for downloading large files.
For such files, it's reasonable to set a long timeout but a small "increment timeout":

```java
File pdf = $("#report").download(using(FOLDER)
  .withTimeout(ofMinutes(10))
  .withIncrementTimeout(ofSeconds(5))
  .withName("report.pdf"));
```

In this case, the overall download timeout is 10 minutes,
BUT if there are no changes in the download folder within 5 seconds, the method will immediately throw an error.

So, if the `#report` link wasn't found at all, the method would wait for 10 minutes.
That's still too long if the locator was simply wrong.
Now it will fail after 5 seconds.

See [issue 3175](https://github.com/selenide/selenide/issues/3175) and [PR 3212](https://github.com/selenide/selenide/pull/3212).

<br>


### Mask credentials in remote URL {#mask-credentials-in-remote-url}

Getting back to the clouds.
Selenide makes it easy to run a browser not only locally, but also "remotely," i.e., on another machine.
On [Selenium Grid, BrowserStack, LambdaTest, Saucelabs, Selenoid, Moon](https://selenide.org/documentation/clouds.html), etc.

To do this, you just need to set the `remote` setting:
```java
Configuration.remote = "https://your-cloud-provider.com/wd/hub";
```

Sometimes these clouds require authentication, and then the username-password can be written directly into the URL:
```java
Configuration.remote = "https://username:password@your-cloud-provider.com/wd/hub";
```

The problem is that Selenide was writing this URL to the logs, exposing the credentials.

Now it will mask it:
```java
23:00:10:763 [main] DEBUG WebDriverFactory - Creating webdriver in thread 1: 
  browser=chrome, browser.version=null, browser.size=1200x960,
  remote=http://***:***@localhost:43008/wd/hub
```

See [issue 3210](https://github.com/selenide/selenide/issues/3210) and [PR 3213](https://github.com/selenide/selenide/pull/3213).

<br>

### Added method `proxy.cleanupFilters()` {#proxy-cleanup-filters}

This is convenient for removing any custom filters added by your tests.
It was already possible with methods `proxy.removeRequestFilter(name)` and `proxy.removeResponseFilter(name)`,
but now they can be removed more easily, without worrying about names. Simply at the end of each test:

```java
  @AfterEach final void done() {
    getSelenideProxy().cleanupFilters();
  } 
```

See [issue 3211](https://github.com/selenide/selenide/issues/3211) and [PR 3215](https://github.com/selenide/selenide/pull/3215).

<br>


### Removed warning about response size {#remove-response-size-watchdog}

When you enable Selenide proxy, among other things, it monitors the size of the server requests or responses,
and issues warnings if the size exceeds 2 MB. In the beginning, it seemed like a good idea, but now we've decided that it
is not Selenide's responsibility. You probably have more suitable monitoring and optimization tools.
And our proxy will work more efficiently without them.

If you really liked these warnings, you can add exactly the same filters to the proxy yourself, in your own tests.

See [PR 3215](https://github.com/selenide/selenide/pull/3215).

<br>


### Added prefix to all Selenide proxy filters {#add-prefix-to-selenide-own-filters}

Selenide has a built-in proxy server that listens to traffic between the browser and the server, allowing you to do all sorts of interesting things with tests. Download files, bypass authentication, spoof server responses, and so on.

To do this, you can add your own filters to the proxy, each with its own unique name (so you can delete them later).
Selenide has several filters, which we don't recommend deleting.

Now they will all have the same prefix "selenide.proxy.filter.", so you won't confuse them with your own.

See [issue 3211](https://github.com/selenide/selenide/issues/3211) and [PR 3215](https://github.com/selenide/selenide/pull/3215).

<br>

### Fixed video rate {#fix-frame-rate-for-video}

Selenide has its own [video recorder](/2024/11/24/selenide-7.6.0/#video-recorder), in which we recently found a tiny problem.
It happened when you requested a high FPS, but had a slow browser.

For example, if you want to generate video with FPS=30, but the browser is slow enough, and can take only 10 screenshots per second,
then the final video was 3 times faster than the reality. :)

The video should now be at normal speed.

See [issue 3189](https://github.com/selenide/selenide/discussions/3189) and [PR 3197](https://github.com/selenide/selenide/pull/3197).

<br>

### Upgraded Selenium from 4.38.0 to 4.39.0 {#update-to-selenium-4.39.0}
Including CDP version update from v142 to v143.

This is a big deal for me personally, as many of my changes made it into this release, and all of them were useful in our release today:
* [Download large files from Grid](https://github.com/SeleniumHQ/selenium/pull/16627)
* [Show file modification time](https://github.com/SeleniumHQ/selenium/pull/16589)
* [make augmentation of HasBiDi/HasDevTools lazy-loaded](https://github.com/SeleniumHQ/selenium/pull/16338)
* [add BiDi method BrowsingContext.setViewport(null, null) to reset the mobile emulation mode](https://github.com/SeleniumHQ/selenium/pull/16524)
* [unwrap double-wrapped webdriver](https://github.com/SeleniumHQ/selenium/pull/16575)
* [Avoid logging debug logs with INFO level](https://github.com/SeleniumHQ/selenium/pull/16584)
* [switch DevTools connection between tabs/windows](https://github.com/SeleniumHQ/selenium/pull/16647)

See [PR 3202](https://github.com/selenide/selenide/pull/3202)

<br>
<br>

> Well then — 
> is the holiday already knocking on your door?

<br>

[Andrei Solntsev](http://asolntsev.github.io/)

selenide.org
